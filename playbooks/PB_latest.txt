SECTION A: BLOCKS_JSON
```json
[
  {
    "block_name": "InitialContextGathering",
    "purpose": "Gather initial details about the affected user and the suspicious IP address from identity providers and threat intelligence.",
    "inputs": [
      "alert_username",
      "alert_source_ip",
      "alert_timestamp_failed_start",
      "alert_timestamp_failed_end",
      "alert_timestamp_success"
    ],
    "outputs": [
      "user_id",
      "user_email",
      "user_display_name",
      "user_manager_email",
      "user_department",
      "user_account_status_ad",
      "source_ip_address",
      "failed_attempts_window_start",
      "failed_attempts_window_end",
      "successful_login_time",
      "current_user_location"
    ],
    "failure_handling": "Log error and proceed with available data. If critical user details are missing, elevate to L1 for manual lookup.",
    "sla_impact": "Low. Essential for subsequent blocks, but partial data allows playbook to progress, potentially requiring manual intervention later.",
    "analyst_notes": "This block establishes the baseline information. Missing details might indicate issues with alert parsing or identity source integration (e.g., Azure AD Graph API). Review the user's current status and location for immediate context."
  },
  {
    "block_name": "AzureAD_Search_BruteForceAttempts",
    "purpose": "Verify the number and timing of failed login attempts for the user from the source IP in Azure AD sign-in logs.",
    "inputs": [
      "user_id",
      "source_ip_address",
      "failed_attempts_window_start",
      "failed_attempts_window_end"
    ],
    "outputs": [
      "azure_ad_failed_attempts_count",
      "azure_ad_failed_attempts_details",
      "is_ip_trusted_vpn"
    ],
    "failure_handling": "Log error, set 'azure_ad_failed_attempts_count' to 0, and notify L1 if Azure AD connectivity issues persist. Mark validation as inconclusive.",
    "sla_impact": "Medium. Crucial for validating the initial alert premise. Failure here significantly impacts incident validation.",
    "analyst_notes": "Review 'azure_ad_failed_attempts_details' for specific error codes (e.g., 'invalid password' vs. 'account disabled'). If 'is_ip_trusted_vpn' is true, this might indicate a legitimate user with a forgotten password, but the high number of attempts is still unusual and requires scrutiny."
  },
  {
    "block_name": "AzureAD_Search_SuccessfulLogin",
    "purpose": "Confirm the successful login event for the user from the source IP in Azure AD sign-in logs and gather details like MFA status, device used, and associated Identity Protection risks.",
    "inputs": [
      "user_id",
      "source_ip_address",
      "successful_login_time"
    ],
    "outputs": [
      "azure_ad_successful_login_details",
      "azure_ad_user_risk_state",
      "azure_ad_mfa_status_used"
    ],
    "failure_handling": "Log error and escalate to L1 for manual verification if successful login cannot be confirmed. This is a critical failure.",
    "sla_impact": "High. This block confirms the core of the compromise. Failure to confirm requires immediate manual intervention and severely impacts MTTR.",
    "analyst_notes": "Pay close attention to 'azure_ad_mfa_status_used'. If MFA was bypassed or not used when expected, it's a higher severity indicator. Check 'azure_ad_user_risk_state' for other Azure AD Identity Protection alerts related to this user."
  },
  {
    "block_name": "IP_ReputationGeolocationCheck",
    "purpose": "Assess the reputation and geographic context of the source IP address using threat intelligence feeds.",
    "inputs": [
      "source_ip_address"
    ],
    "outputs": [
      "ip_reputation_score",
      "ip_reputation_feed_matches",
      "ip_geolocation_country",
      "ip_geolocation_city",
      "ip_is_proxy_vpn_tor"
    ],
    "failure_handling": "Log error and proceed with default values (e.g., 'unknown reputation'). This block is supplementary.",
    "sla_impact": "Low. Provides valuable context but is not a showstopper if the service integration fails.",
    "analyst_notes": "A high 'ip_reputation_score' or 'ip_is_proxy_vpn_tor' indicates higher risk. Compare 'ip_geolocation_country' with the user's typical login locations and 'current_user_location' for travel anomalies."
  },
  {
    "block_name": "EDR_ActivityCheck",
    "purpose": "Check for suspicious activity on the user's primary endpoint or other associated endpoints, specifically login activity from the source IP or unusual process execution.",
    "inputs": [
      "user_id",
      "source_ip_address",
      "successful_login_time"
    ],
    "outputs": [
      "edr_login_events_from_ip",
      "edr_unusual_process_activity_user",
      "edr_alerts_for_user_device"
    ],
    "failure_handling": "Log error and set outputs to empty. Escalates to L1 for manual EDR search if EDR connectivity fails.",
    "sla_impact": "Medium. Important for understanding potential post-compromise activity and lateral movement within the endpoint. Missing data might delay full scope assessment.",
    "analyst_notes": "If 'edr_login_events_from_ip' confirms login from the suspicious IP, and 'edr_unusual_process_activity_user' shows suspicious processes, elevate the incident severity. Check if the device is corporate-owned."
  },
  {
    "block_name": "Firewall_LogAnalysis",
    "purpose": "Check firewall logs for any outbound connections initiated by the 'source_ip' or inbound connections attempting to reach internal resources after the successful login.",
    "inputs": [
      "source_ip_address",
      "successful_login_time"
    ],
    "outputs": [
      "firewall_connections_from_ip",
      "firewall_blocked_attempts_for_ip"
    ],
    "failure_handling": "Log error and set outputs to empty. This block provides supplementary information.",
    "sla_impact": "Low. Useful for identifying lateral movement or C2 activity but not critical for initial containment.",
    "analyst_notes": "Look for connections from the 'source_ip' to unusual external destinations, or attempts to reach sensitive internal resources after the successful login. Review firewall alerts for this IP during the compromise window."
  },
  {
    "block_name": "AssessCompromiseConfidence",
    "purpose": "Aggregate all collected data to assign a confidence score for account compromise and recommend an action level.",
    "inputs": [
      "azure_ad_failed_attempts_count",
      "azure_ad_successful_login_details",
      "ip_reputation_score",
      "ip_geolocation_country",
      "ip_is_proxy_vpn_tor",
      "user_account_status_ad",
      "azure_ad_user_risk_state",
      "edr_unusual_process_activity_user",
      "firewall_connections_from_ip",
      "is_ip_trusted_vpn",
      "azure_ad_mfa_status_used"
    ],
    "outputs": [
      "compromise_confidence_level",
      "recommended_action",
      "reasoning_summary"
    ],
    "failure_handling": "Log error, default 'compromise_confidence_level' to 'Medium', and 'recommended_action' to 'Manual_Review'.",
    "sla_impact": "High. This block applies the core logic and dictates the subsequent automation flow. Accurate scoring is vital.",
    "analyst_notes": "This block relies on a weighted scoring mechanism. Review 'reasoning_summary' to understand the automated decision. If the confidence level seems incorrect, L1/L2 should override the 'recommended_action' and manually proceed."
  },
  {
    "block_name": "AutomatedContainment",
    "purpose": "Execute immediate containment actions (password reset, session revocation, IP blocking, temporary account disablement) if the compromise confidence is 'High'.",
    "inputs": [
      "user_id",
      "source_ip_address",
      "compromise_confidence_level"
    ],
    "outputs": [
      "password_reset_status",
      "all_sessions_revoked_status",
      "ip_blocked_firewall_status",
      "user_account_disabled_status",
      "containment_actions_summary"
    ],
    "failure_handling": "If any action fails, log the error, set the corresponding status to 'Failed', create a high-priority ticket for L1 to perform manually, and notify L2 immediately.",
    "sla_impact": "High. Direct and immediate impact on containing a confirmed threat. Failure means an active threat remains.",
    "analyst_notes": "This block should only execute if 'compromise_confidence_level' is 'High'. L1/L2 must verify 'containment_actions_summary'. If any actions failed, immediately proceed with manual remediation. Ensure user notification procedures are followed post-containment."
  },
  {
    "block_name": "EvidenceCollectionCaseManagement",
    "purpose": "Collect all relevant logs and data, attach them to a new incident case in the SOAR/SIEM, and prepare for L1/L2 review.",
    "inputs": [
      "InitialContextGathering.outputs",
      "AzureAD_Search_BruteForceAttempts.outputs",
      "AzureAD_Search_SuccessfulLogin.outputs",
      "IP_ReputationGeolocationCheck.outputs",
      "EDR_ActivityCheck.outputs",
      "Firewall_LogAnalysis.outputs",
      "AssessCompromiseConfidence.outputs",
      "AutomatedContainment.outputs"
    ],
    "outputs": [
      "incident_case_id",
      "evidence_archive_path",
      "raw_logs_attached_status"
    ],
    "failure_handling": "Log error, create a basic incident with a note that evidence collection failed. Escalate to L1 for manual evidence gathering.",
    "sla_impact": "Medium. Important for post-incident analysis, compliance, and potential forensic investigation. Delays impact incident resolution quality.",
    "analyst_notes": "Ensure all relevant logs are available through 'evidence_archive_path'. The 'incident_case_id' will be the primary reference for all follow-up actions. Verify 'raw_logs_attached_status' to confirm data integrity."
  },
  {
    "block_name": "NotifyAnalystsAndManager",
    "purpose": "Create a high-priority incident ticket for L1/L2 analysts and optionally notify the affected user's manager about the incident.",
    "inputs": [
      "incident_case_id",
      "user_id",
      "user_manager_email",
      "compromise_confidence_level",
      "containment_actions_summary",
      "reasoning_summary",
      "recommended_action",
      "user_email"
    ],
    "outputs": [
      "ticket_system_id",
      "analyst_notification_status",
      "manager_notification_status"
    ],
    "failure_handling": "Log error. If notification fails, ensure 'incident_case_id' is logged and accessible for manual follow-up by L1.",
    "sla_impact": "High. Critical for human intervention and timely resolution. Failure delays response and increases MTTR.",
    "analyst_notes": "L1 analysts should immediately review the 'incident_case_id' for full details, verify automated containment, and proceed with user communication and further investigation. Manager notification is conditional on 'compromise_confidence_level' (e.g., High) and should be handled sensitively after internal SOC review."
  }
]
```

SECTION B: DOCUMENTATION_TEXT
# SOAR Playbook: Account Compromise – Brute Force Success Response

**Version:** 1.0
**Date:** 2023-10-27
**Author:** AI Automation Agent
**Reviewer:** SOC L2, Incident Response Lead

---

## 1. Overview

This playbook is designed to automate the detection, validation, containment, and notification processes for an "Account Compromise – Brute Force Success" incident. It addresses scenarios where a user account experiences multiple failed authentication attempts followed by a successful login from the same suspicious external IP address within a short timeframe. The playbook leverages integrations with Azure AD, Endpoint Detection and Response (EDR), and Firewall logs to provide comprehensive context and automate response actions, ensuring rapid containment and evidence preservation.

## 2. Trigger

This playbook is triggered by a SIEM alert indicating:
*   Multiple (e.g., >20) failed authentication attempts for a single user account from a unique external IP address within a 10-minute window.
*   A subsequent successful login for the same user account from the *same* external IP address shortly after the failed attempts.

## 3. Objectives

The primary objectives of this playbook are to:
*   **Validate** whether the alert represents a true account compromise.
*   **Automatically contain** high-confidence threats to minimize impact.
*   **Preserve evidence** for forensic analysis and post-incident review.
*   **Notify** SOC L1/L2 analysts with clear incident context and next steps.
*   Reduce Mean Time to Detect (MTTD) and Mean Time to Respond (MTTR) for such incidents.

## 4. Scope

This playbook primarily focuses on:
*   **Identity Management:** Azure AD for user authentication logs and account management.
*   **Endpoint Security:** EDR for endpoint activity associated with the user.
*   **Network Security:** Firewall logs for network connections related to the source IP.
*   **Operational Scope:** Applicable to 24x7 SOC operations, leveraging L1 and L2 analysts.

## 5. MITRE ATT&CK Mapping

| Tactic               | Technique ID | Technique Name          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | T1110.001 - Brute Force: Password Guessing | An adversary attempts to guess valid account credentials via trial-and-error. | Initial Access, Credential Access |
| Tactic               | Technique ID | Technique Name          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | T2004 - T1110 - Brute Force | Attempting to gain specific access using brute force attacks on known valid accounts. |
| **Mitre Attack Phases:**                   | **Phase 1: Initial Access**                                                                                                                                                                      | T1078 Valid Accounts: Brute force attempts and subsequent successful login indicate the use or acquisition of valid credentials.                                                                                                                                                                                                                                                                                                        |
|                                            | **Phase 2: Credential Access**                                                                                                                                                                   | T1110 Brute Force: The presence of multiple failed logins before a successful one from the same IP directly points to a brute force attack succeeding.                                                                                                                                                                                                                                                                                   |
| **NIST SP 800-61r2 Incident Response Phases:** |                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **1. Preparation**                         | (Implicit) The SOAR platform, SIEM, EDR, Azure AD, and Firewall integrations are pre-configured. Playbook is developed and tested.                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| **2. Detection & Analysis**                | *   **Trigger:** SIEM alert (multiple failed, then successful login).                                                                                                                             |
|                                            | *   **Block 1: InitialContextGathering:** Parses alert, gathers user/IP details.                                                                                                                   |
|                                            | *   **Block 2: AzureAD_Search_BruteForceAttempts:** Verifies failed login patterns.                                                                                                                |
|                                            | *   **Block 3: AzureAD_Search_SuccessfulLogin:** Confirms successful login and gathers session details.                                                                                            |
|                                            | *   **Block 4: IP_ReputationGeolocationCheck:** Checks IP reputation and location for anomalies.                                                                                                   |
|                                            | *   **Block 5: EDR_ActivityCheck:** Searches for concurrent endpoint activity.                                                                                                                     |
|                                            | *   **Block 6: Firewall_LogAnalysis:** Investigates network connections from the source IP.                                                                                                        |
|                                            | *   **Block 7: AssessCompromiseConfidence:** Correlates all data to determine incident confidence level.                                                                                           |
| **3. Containment, Eradication, & Recovery**| *   **Block 8: AutomatedContainment:** Executes immediate actions for high-confidence compromises (e.g., password reset, session revocation, IP block, temporary account disablement).              |
|                                            | *   **L1/L2 Analyst Action:** For medium/low confidence, or if automated containment fails, analysts manually perform containment, eradicate the threat, and guide user recovery.                 |
| **4. Post-Incident Activity**              | *   **Block 9: EvidenceCollectionCaseManagement:** Gathers all relevant data and logs for forensic review and attaches to the incident case.                                                     |
|                                            | *   **Block 10: NotifyAnalystsAndManager:** Creates incident ticket, notifies SOC L1/L2, and relevant stakeholders (e.g., user's manager).                                                            |
|                                            | *   **L2 Analyst/IR Team Action:** Conducts root cause analysis, performs remediation verification, system hardening, and playbook review.                                                        |

---

## 7. Workflow Diagram (High-Level)

**SIEM Alert Trigger**
    ↓
**Initial Context Gathering & Enrichment (User, IP)**
    ↓
**Azure AD Log Verification (Failed & Successful Logins)**
    ↓
**Threat Intelligence & Internal Log Correlation (IP Reputation, EDR, Firewall)**
    ↓
**Compromise Confidence Assessment**
    ↓
**[IF High Confidence] → Automated Containment (Password Reset, Session Revoke, IP Block, Account Disable)**
    ↓
**Evidence Collection & Incident Case Creation**
    ↓
**Notify SOC L1/L2 & Manager (Conditional)**
    ↓
**[END AUTOMATION] → L1/L2 Manual Investigation & Remediation**

---

## 8. Detailed Playbook Steps

This section details the automated blocks and associated manual steps for SOC analysts.

### Step 1: Alert Ingestion & Initial Context
*   **SOAR Block(s) Involved:** `InitialContextGathering`
*   **Description:** The playbook parses the SIEM alert to extract critical entities like the affected `username` and `source_ip`. It then queries Azure AD to retrieve comprehensive user details (ID, email, manager, department, account status) and performs an initial lookup for the source IP's geolocation and known threat intelligence.
*   **Automated Actions:**
    *   Extracts `username`, `source_ip`, `failed_attempt_timestamps`, `successful_login_timestamp`.
    *   Queries Azure AD for `user_id`, `user_email`, `user_manager_email`, `user_department`, `user_account_status_ad`.
    *   Determines `current_user_location` based on recent legitimate logins.
*   **Analyst Action (if automation fails/partially fails):**
    *   If user or IP details are missing, L1 must manually look up information in Azure AD or public IP intelligence tools.

### Step 2: Brute Force & Successful Login Verification
*   **SOAR Block(s) Involved:** `AzureAD_Search_BruteForceAttempts`, `AzureAD_Search_SuccessfulLogin`
*   **Description:** The playbook queries Azure AD sign-in logs to confirm the failed attempts count within the specified window and verifies the subsequent successful login from the identified `source_ip`. It also checks for MFA status during the successful login and any Azure AD Identity Protection risks.
*   **Automated Actions:**
    *   Searches Azure AD for failed login attempts by `user_id` from `source_ip` during the `failed_attempts_window`.
    *   Counts `azure_ad_failed_attempts_count` and extracts `azure_ad_failed_attempts_details`.
    *   Checks if `source_ip` is a known trusted VPN endpoint.
    *   Searches Azure AD for the `successful_login_time` by `user_id` from `source_ip`.
    *   Extracts `azure_ad_successful_login_details`, `azure_ad_user_risk_state`, and `azure_ad_mfa_status_used`.
*   **Analyst Action (if automation fails):**
    *   L1 must manually search Azure AD sign-in logs to confirm both the failed attempts and the successful login. If the successful login cannot be manually confirmed, the incident requires immediate L2 escalation.

### Step 3: Threat Intelligence & Activity Correlation
*   **SOAR Block(s) Involved:** `IP_ReputationGeolocationCheck`, `EDR_ActivityCheck`, `Firewall_LogAnalysis`
*   **Description:** The playbook enriches the incident data by checking the source IP's reputation against threat intelligence feeds, examining endpoint activity via EDR, and correlating with firewall logs for any post-login network movements.
*   **Automated Actions:**
    *   Queries external Threat Intelligence for `ip_reputation_score`, `ip_reputation_feed_matches`, `ip_geolocation_country`, `ip_geolocation_city`, and `ip_is_proxy_vpn_tor`.
    *   Queries EDR for `edr_login_events_from_ip`, `edr_unusual_process_activity_user`, and `edr_alerts_for_user_device` around the `successful_login_time`.
    *   Queries Firewall logs for `firewall_connections_from_ip` and `firewall_blocked_attempts_for_ip` from the `source_ip`.
*   **Analyst Action (if automation fails):**
    *   L1 should manually check IP reputation via available TI platforms (e.g., VirusTotal, AbuseIPDB).
    *   L1 should manually query EDR console for user endpoint activity and firewall logs for relevant network traffic.

### Step 4: Compromise Assessment & Decision
*   **SOAR Block(s) Involved:** `AssessCompromiseConfidence`
*   **Description:** All collected data points are aggregated and analyzed by the SOAR platform's logic to determine a 'Compromise Confidence Level' (High, Medium, Low) and a `recommended_action`.
*   **Automated Actions:**
    *   Applies a weighted scoring model based on factors like: `azure_ad_failed_attempts_count`, `ip_reputation_score`, `ip_geolocation_country` vs. `user_location_history`, `ip_is_proxy_vpn_tor`, `azure_ad_user_risk_state`, `edr_unusual_process_activity_user`, `firewall_connections_from_ip`, and `azure_ad_mfa_status_used`.
    *   Outputs `compromise_confidence_level` and `recommended_action` (e.g., 'Automate_Containment', 'Manual_Review').
*   **Analyst Action (if automation fails/logic override):**
    *   If automation fails to assign a score, L1 reviews all collected data and manually assigns a confidence level.
    *   L1/L2 can override the automated `recommended_action` if contextual information (e.g., known legitimate travel, executive user) suggests otherwise.

### Step 5: Automated Containment (Conditional)
*   **SOAR Block(s) Involved:** `AutomatedContainment`
*   **Description:** If `compromise_confidence_level` is 'High', the playbook automatically initiates containment actions in Azure AD and the firewall.
*   **Automated Actions:**
    *   **If 'High' Confidence:**
        *   Forces `user_id` password reset in Azure AD.
        *   Revokes all `user_id` sessions in Azure AD.
        *   Blocks `source_ip_address` at the perimeter firewall.
        *   Temporarily disables `user_id` account in Azure AD (optional, configurable based on risk appetite).
    *   Records `containment_actions_summary` (status of each action).
*   **Analyst Action (if automation fails or 'Medium/Low' confidence):**
    *   **If automation fails:** L1 immediately attempts to perform manual containment actions (password reset, session revocation, IP block, account disablement) and notifies L2.
    *   **If 'Medium/Low' Confidence:** L1 reviews the `recommended_action` and proceeds with manual containment actions as deemed appropriate after further investigation.
    *   L1 initiates contact with the user to verify activity and guide them through account recovery if necessary.

### Step 6: Evidence Preservation & Case Creation
*   **SOAR Block(s) Involved:** `EvidenceCollectionCaseManagement`
*   **Description:** All collected data, logs, and outputs from previous blocks are compiled and attached to a new incident case within the SOAR/SIEM platform for historical record and further analysis.
*   **Automated Actions:**
    *   Generates a unique `incident_case_id`.
    *   Exports and attaches relevant Azure AD, EDR, and Firewall logs to the case.
    *   Records all enrichment data and actions taken within the incident context.
*   **Analyst Action (if automation fails):**
    *   L1 creates a new incident ticket in the SOAR/SIEM, manually collects and attaches relevant log snippets or references to logs, and ensures all available context is documented.

### Step 7: Notification & Escalation
*   **SOAR Block(s) Involved:** `NotifyAnalystsAndManager`
*   **Description:** The playbook creates a detailed incident ticket for SOC L1/L2 and, conditionally, notifies the affected user's manager.
*   **Automated Actions:**
    *   Creates a new incident ticket in the primary ticketing system (e.g., SOAR case management, ServiceNow) with `incident_case_id`, `user_id`, `source_ip_address`, `compromise_confidence_level`, `containment_actions_summary`, and `reasoning_summary`.
    *   Notifies SOC L1 and L2 via internal communication channels (e.g., Slack, Teams, email).
    *   **Conditional:** If `compromise_confidence_level` is 'High', sends an email to `user_manager_email` informing them of a potential compromise and actions taken, advising them to await further instructions from the SOC.
*   **Analyst Action (L1/L2):**
    *   L1 immediately picks up the new incident ticket, reviews the automated actions, and begins further investigation.
    *   L1/L2 coordinates with the affected user and their manager (if not already notified) to confirm the incident, verify containment, and initiate recovery steps.
    *   L2 escalates to the Incident Response Team if widespread impact, sensitive data exposure, or executive accounts are involved.

---

## 9. Roles and Responsibilities

*   **SOAR Platform:** Executes automated tasks, orchestrates workflow, collects and stores evidence, manages incident state.
*   **L1 SOC Analyst:**
    *   Initial review of triggered incidents.
    *   Validates automated findings and containment.
    *   Performs manual containment if automation fails or for medium-confidence incidents.
    *   Communicates with affected users (post-validation/containment).
    *   Escalates complex issues to L2.
*   **L2 SOC Analyst:**
    *   Conducts deeper investigation and forensic analysis.
    *   Approves or overrides automated actions based on additional context.
    *   Coordinates with other teams (IT, HR, Legal).
    *   Manages communication with management and external parties (if necessary).
    *   Contributes to playbook refinement.
*   **IT Administration/Help Desk:**
    *   Assists users with account recovery (e.g., password reset, MFA re-enrollment).
    *   Provides device support for affected endpoints.
*   **Human Resources (HR):**
    *   Engaged for sensitive employee-related incidents, particularly if involving policy violations or requiring disciplinary action.

---

## 10. Escalation Paths

*   **L1 to L2 SOC Analyst:**
    *   Inability to validate incident.
    *   Automated containment failure.
    *   Incident involves critical/executive accounts.
    *   Suspicion of wider compromise or lateral movement.
    *   Lack of clear remediation steps.
*   **L2 SOC Analyst to Incident Response (IR) Team:**
    *   Confirmed widespread breach affecting multiple users/systems.
    *   High-risk data exfiltration suspected.
    *   Adversary persistence detected after initial containment.
    *   Incidents with significant legal or reputational implications.
*   **L2 SOC Analyst to Management/Legal:**
    *   High-profile incidents, potential regulatory reporting requirements, or significant business impact.

---

## 11. Evidence Preservation Policy

All relevant digital evidence is collected and preserved to support forensic analysis, legal requirements, and post-incident review.
*   **Automated Collection:** The SOAR platform exports and attaches logs from Azure AD (sign-in, audit), EDR, and Firewall directly to the incident case (`evidence_archive_path`).
*   **Manual Collection (if needed):** If automation fails, L1/L2 analysts will manually collect relevant logs, screenshots of configurations, and system states.
*   **Storage:** Evidence is stored securely within the SOAR/SIEM incident platform and/or a designated secure long-term storage solution, ensuring integrity and auditability.
*   **Chain of Custody:** All automated and manual actions are logged within the SOAR platform, providing an auditable chain of custody for all evidence.

---

## 12. Communication Plan

*   **Internal SOC (L1/L2):** Incident tickets, chat (e.g., Microsoft Teams, Slack), and email notifications (Automated via `NotifyAnalystsAndManager` block).
*   **Affected User:** Communicated by L1 or L2 after initial validation and containment are complete. Instructions for account recovery and security best practices will be provided.
*   **User's Manager:** Notified by L1/L2 (or automated if high confidence) for awareness and coordination. This communication must be handled with care and follow internal protocols regarding employee privacy.
*   **IT Administration/Help Desk:** Engaged by L1/L2 for account recovery assistance and endpoint remediation.
*   **Legal/PR/HR:** Engaged by L2/IR Lead only when the incident involves sensitive data, potential legal implications, or widespread impact.

---

## 13. Metrics

*   **Mean Time to Detect (MTTD):** Time from brute force success to alert trigger.
*   **Mean Time to Respond (MTTR):** Time from alert trigger to automated or manual containment completion.
*   **Automation Success Rate:** Percentage of incidents where automated containment actions complete successfully without manual intervention.
*   **False Positive Rate:** Number of times the playbook is triggered but determined not to be a true compromise.
*   **Analyst Intervention Rate:** Number of incidents requiring L1/L2 analyst modification of automated actions or manual remediation.

---

## 14. Playbook Review Cycle

This playbook will be reviewed:
*   **Quarterly:** To ensure continued relevance and effectiveness.
*   **After Major Incidents:** To incorporate lessons learned from high-severity events.
*   **Upon Major System Changes:** If Azure AD, EDR, Firewall, or SIEM configurations are significantly altered.
*   **Upon New Threat Intelligence:** When new attacker techniques related to brute force or account compromise emerge.